---
import { getCollection, render } from "astro:content";
import Base from "../../layouts/Base.astro";
import Giscus from "../../components/Giscus.astro";

export async function getStaticPaths() {
  const journals = await getCollection("journals");
  return journals.map((journal) => ({
    params: { id: journal.id },
    props: { journal },
  }));
}

const { journal } = Astro.props;
const { Content } = await render(journal);

// Parse date from filename (2026_01_02 -> 2026-01-02)
const dateStr = journal.id.replace(/_/g, "-");
const date = new Date(dateStr).toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<Base title={`Journal: ${dateStr}`}>
  <nav style="margin-bottom: 2rem;">
    <a href="/">‚Üê Home</a>
  </nav>

  <article>
    <header>
      <h1>{date}</h1>
    </header>

    <div class="prose" style="margin-top: 2rem;">
      <Content />
    </div>
  </article>

  <Giscus category="Journals" categoryId="" />
</Base>

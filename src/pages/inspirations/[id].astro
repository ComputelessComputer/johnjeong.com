---
import { getCollection, render } from "astro:content";
import Base from "../../layouts/Base.astro";
import Giscus from "../../components/Giscus.astro";

export async function getStaticPaths() {
  const inspirations = await getCollection("inspirations");
  return inspirations.map((inspiration) => ({
    params: { id: inspiration.id },
    props: { inspiration },
  }));
}

const { inspiration } = Astro.props;
const { Content } = await render(inspiration);

const date = inspiration.data.created_at.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});
---

<Base title={inspiration.data.title}>
  <nav style="margin-bottom: 2rem;">
    <a href="/">← Home</a>
  </nav>

  <article>
    <header>
      <h1>{inspiration.data.title}</h1>
      <p style="color: #666;">
        {inspiration.data.type}
        {inspiration.data.speaker && ` · ${inspiration.data.speaker}`}
        {" · "}{date}
      </p>
    </header>

    {inspiration.data.youtube_video_id && (
      <div style="margin: 2rem 0; aspect-ratio: 16/9;">
        <iframe
          width="100%"
          height="100%"
          src={`https://www.youtube.com/embed/${inspiration.data.youtube_video_id}`}
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      </div>
    )}

    <div class="prose" style="margin-top: 2rem;">
      <Content />
    </div>
  </article>

  <Giscus category="inspirations" />
</Base>

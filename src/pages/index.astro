---
import { getCollection } from "astro:content";
import Base from "../layouts/Base.astro";

const essays = await getCollection("essays");
const journals = await getCollection("journals");
const inspirations = await getCollection("inspirations");
const lessons = await getCollection("lessons");

// Sort by date descending
const sortedEssays = essays.sort((a, b) =>
  new Date(b.data.created_at).getTime() - new Date(a.data.created_at).getTime()
);
const sortedJournals = journals.sort((a, b) => b.id.localeCompare(a.id));
const sortedInspirations = inspirations.sort((a, b) =>
  new Date(b.data.created_at).getTime() - new Date(a.data.created_at).getTime()
);
const sortedLessons = lessons.sort((a, b) =>
  new Date(b.data.created_at).getTime() - new Date(a.data.created_at).getTime()
);
---

<Base title="John Jeong">
  <header>
    <h1>John Jeong</h1>
    <p>Part of my brain.</p>
  </header>

  <nav style="margin: 2rem 0;">
    <a href="/essays">Essays</a> 路
    <a href="/journals">Journals</a> 路
    <a href="/inspirations">Inspirations</a> 路
    <a href="/lessons">Lessons</a> 路
    <a href="/questions">Questions</a>
  </nav>

  <section>
    <h2>Recent Essays</h2>
    <ul>
      {sortedEssays.slice(0, 5).map((essay) => (
        <li><a href={`/essays/${essay.id}`}>{essay.data.title}</a></li>
      ))}
    </ul>
  </section>

  <section>
    <h2>Recent Journals</h2>
    <ul>
      {sortedJournals.slice(0, 5).map((journal) => (
        <li><a href={`/journals/${journal.id}`}>{journal.id.replace(/_/g, "-")}</a></li>
      ))}
    </ul>
  </section>

  <section>
    <h2>Recent Inspirations</h2>
    <ul>
      {sortedInspirations.slice(0, 5).map((inspiration) => (
        <li><a href={`/inspirations/${inspiration.id}`}>{inspiration.data.title}</a></li>
      ))}
    </ul>
  </section>

  <section>
    <h2>Recent Lessons</h2>
    <ul>
      {sortedLessons.slice(0, 5).map((lesson) => (
        <li><a href={`/lessons/${lesson.id}`}>{lesson.data.title}</a></li>
      ))}
    </ul>
  </section>
</Base>
